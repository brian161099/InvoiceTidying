# 【財政部電子發票整合服務平台-消費發票彙整通知】轉換Excel表格程式
## 目的
爲了將格式複雜的資料集，整理出只保留重要資訊（例：消費日期、店家及金額）的Excel資料檔案。

## 產出資料集欄位
每張發票的每一個品項（明細）會佔一列資料。
1. invoice_number：發票號碼
2. invoice_date：消費日期
3. seller_name：消費店家
4. amount：消費金額
5. description：消費品項敘述


## 資料集示例
invoice_number*	|	invoice_date	|	seller_name	|	amount	|	description
----  	|	----  	|	----  	|	----  	|	----  
AY7300***6	|	2024-05-02 00:00:00	|	安心食品服務股份有限公司瑞光分公司	|	99	|	T56雞塊夯地瓜
AY7300***6	|	2024-05-02 00:00:00	|	安心食品服務股份有限公司瑞光分公司	|	70	|	摩斯鱈魚堡

*示例中的發票號碼因資訊安全考慮予以遮罩，真實執行情況會產出完整發票號碼。

## 額外資料轉換工程
1. 去除消費金額為0的品項。
2. 移除折扣金額（消費金額為負值）的品項，將其納入同一筆發票金額最高的品項，並在此品項敘述後方注記「*** 折扣敘述」。
   - 若納入後此品項金額會變成負值，則將折扣分攤給同一筆發票其他品項，攤提比例為每個品項自身金額。

## 使用方式
1. 將【財政部電子發票整合服務平台-消費發票彙整通知】檔案放入"input_folder"。
   - 可接受複數檔案。
2. 執行main.py。
3. 每個檔案轉換好的Excel檔會儲存在"output_folder"内。
